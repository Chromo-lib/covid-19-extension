!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";let e=document.querySelector("header");class t{static setHeader(t="tunisia"){e.children[0].textContent=t,e.children[1].textContent=(new Date).toDateString()}static hideHeader(t=!0){e.style.display=t?"block":"none",t?document.getElementById("root").classList.remove("mt-30"):document.getElementById("root").classList.add("mt-30")}static createListCountries(e,t){const s=document.createElement("ul");s.innerHTML=function(e){const{cases:t,deaths:s,recovered:n,todayCases:l,todayDeaths:o}=e,r={cases:a(t),deaths:a(s),recovered:a(n),todayCases:a(l),todayDeaths:a(o),casesDeaths:parseInt(s/t*100,10)+"%"};return Object.values(r).map(e=>`<li>${e}</li>`)}(t).join("");const n=document.createElement("div");n.innerHTML='<ul class="txt-bleu mb-5">\n    <li>Total Cases</li>\n    <li>total deaths</li>\n    <li>Total recovered</li>\n    <li>today Cases</li>\n    <li>today Deaths</li>\n    <li>deaths / Cases</li>\n  </ul>',n.classList.add("d-flex-col","justify-between"),n.appendChild(s);const l=document.createElement("div");l.appendChild(function(e){const{countryInfo:t}=e,a=document.createElement("img");a.src=t.flag,a.alt=e.country,a.classList.add("mb-5");const s=document.createElement("span");s.textContent=e.country,s.classList.add("truncate");const n=document.createElement("div");return n.appendChild(a),n.appendChild(s),n.classList.add("box"),n}(t)),l.appendChild(n),l.classList.add("d-flex","py-1","border-bottom"),e.appendChild(l)}static formatNumber(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}}function a(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}class s{static async fetchData(e="tunisia"){try{let t=await fetch("https://corona.lmao.ninja/v2/countries/"+e),a=await t.json();if(a&&a.message)throw a.message;return a}catch(e){}}}let n=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);chrome=n?chrome:browser;let l=10,o=[],r={},c="tunisia";const d=document.getElementById("nav");let i=document.getElementById("tab-stats");const u=document.getElementById("list-countries"),m=document.getElementById("form-change-country"),h=document.getElementById("btn-load-more");function b({showHeader:e,showForm:a,showBtnMore:s,showStatsTabEl:n}){m.style.display=a,h.style.display=s,u.innerHTML="",t.hideHeader(e),i.style.display=n}function f(){let e=o.reduce((e,t)=>e+t.cases,0),a=o.reduce((e,t)=>e+t.deaths,0),s=o.reduce((e,t)=>e+t.recovered,0),n=parseInt(a/e*100,10),l=parseInt(s/e*100,10),r=o.reduce((e,t)=>e+t.todayCases,0),c=o.reduce((e,t)=>e+t.todayDeaths,0),d=o.reduce((e,t)=>e+t.todayRecovered,0);i.innerHTML=`\n  <ul class="w-100">\n  <li class="d-flex-col li-bordred"><span class="txt-bleu mb-5">total today cases</span> ${t.formatNumber(r)}</li>\n  <li class="d-flex-col li-bordred"><span class="txt-bleu mb-5">total today cases</span> ${t.formatNumber(c)}</li>\n  <li class="d-flex-col li-bordred"><span class="txt-bleu mb-5">total today Recovered</span> ${t.formatNumber(d)}</li>\n  </ul>\n\n  <ul class="w-100">\n  <li class="d-flex-col li-bordred"><span class="txt-bleu mb-5">total cases</span> ${t.formatNumber(e)}</li>\n  <li class="d-flex-col li-bordred"><span class="txt-bleu mb-5">total deaths</span> ${t.formatNumber(a)}</li>\n  <li class="d-flex-col li-bordred"><span class="txt-bleu mb-5">total Recovered</span> ${t.formatNumber(s)}</li>  \n  </ul>\n  \n  <ul class="w-100">\n    <li class="li-bordred d-flex-col">\n      <div class="ct-chart ct-perfect-fourth"></div>\n      <span>total Recovered ${t.formatNumber(s)}</span>\n      <span class="txt-red">total Deaths ${t.formatNumber(a)}</span>\n    </li>\n    <li class="li-bordred d-flex-col">\n      <div class="ct-chartt ct-perfect-fourth"></div>\n      <span>today Recovered ${t.formatNumber(d)}</span>\n      <span class="txt-red">today Deaths ${t.formatNumber(c)}</span>\n    </li>\n  </ul>\n  \n  <ul class="w-100">\n  <li class="d-flex-col li-bordred"><span class="txt-bleu mb-5">total deaths/<br >total cases</span> ${n}%</li>\n  <li class="d-flex-col li-bordred"><span class="txt-bleu mb-5">total Recovered/<br >total cases</span> ${l}%</li>\n  </ul>`,new Chartist.Pie(".ct-chart",{series:[s,a]},{showLabel:!1}),new Chartist.Pie(".ct-chartt",{series:[d,c]},{showLabel:!1})}function p(){o.sort((e,t)=>+t.cases-+e.cases).slice(0,l).forEach(e=>{t.createListCountries(u,e)}),h.addEventListener("click",()=>{l+=10,h.style.display="block",u.innerHTML="",o.sort((e,t)=>+t.cases-+e.cases).slice(0,l).forEach(e=>{t.createListCountries(u,e)})},!1)}chrome.storage.local.get(["defaultCountryName"],(function(e){b({showForm:"none",showBtnMore:"none"}),e&&e.defaultCountryName?s.fetchData(e.defaultCountryName).then(a=>{c=e.defaultCountryName,r=a,t.setHeader(c),t.createListCountries(u,a)}).catch(e=>{chrome.storage.local.set({defaultCountryName:"tunisia"}),window.location.reload()}):s.fetchData().then(e=>{r=e,t.setHeader(c),t.createListCountries(u,e)}).catch(e=>{})})),d.addEventListener("click",(function(e){switch(e.target.id||e.target.parentNode.id){case"all":b({showHeader:!1,showForm:"none",showBtnMore:"block",showStatsTabEl:"none"}),o.length>0&&p(),s.fetchData("").then(e=>{o=e.slice(0),p()});break;case"settings":b({showHeader:!1,showForm:"block",showBtnMore:"none",showStatsTabEl:"none"});let e=document.getElementById("alert");m.addEventListener("submit",t=>{t.preventDefault();let a=t.target.elements[0].value;/^[a-zA-Z]+$/.test(a)?(t.target.elements[0].disabled=!0,t.target.elements[1].disabled=!0,t.target.elements[1].textContent="Changed",t.target.elements[1].classList.add("bg-bleu"),e.style.display="none",chrome.storage.local.set({defaultCountryName:a}),window.location.reload()):(e.style.display="block",e.textContent="Invalid country name")},!1);break;case"stats":b({showHeader:!1,showForm:"none",showBtnMore:"none",showStatsTabEl:"flex"}),o.length>0?f():s.fetchData("").then(e=>{o=e.slice(0),f()});break;default:b({showHeader:!0,showForm:"none",showBtnMore:"none",showStatsTabEl:"none"}),r&&t.createListCountries(u,r)}Array.from(d.children).forEach(e=>{e.classList.remove("active-tab")}),e.target.id?e.target.classList.add("active-tab"):e.target.parentNode.classList.add("active-tab")}),!1)}));
