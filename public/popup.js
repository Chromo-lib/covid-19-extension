!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";let e=document.querySelector("header");class t{static setHeader(t="tunisia"){e.children[0].textContent=t,e.children[1].textContent=(new Date).toDateString()}static hideHeader(t=!0){e.style.display=t?"block":"none",t?document.getElementById("root").classList.remove("mt-30"):document.getElementById("root").classList.add("mt-30")}static createListCountries(e,t){const s=document.createElement("ul");s.innerHTML=function(e){const{cases:t,deaths:s,recovered:n,todayCases:o,todayDeaths:l}=e,c={cases:a(t),deaths:a(s),recovered:a(n),todayCases:a(o),todayDeaths:a(l),casesDeaths:parseInt(s/t*100,10)+"%"};return Object.values(c).map(e=>`<li>${e}</li>`)}(t).join("");const n=document.createElement("div");n.innerHTML='<ul class="txt-bleu mb-5">\n    <li>Total Cases</li>\n    <li>total deaths</li>\n    <li>Total recovered</li>\n    <li>today Cases</li>\n    <li>today Deaths</li>\n    <li>deaths / Cases</li>\n  </ul>',n.classList.add("d-flex-col","justify-between"),n.appendChild(s);const o=document.createElement("div");o.appendChild(function(e){const{countryInfo:t}=e,a=document.createElement("img");a.src=t.flag,a.alt=e.country,a.classList.add("mb-5");const s=document.createElement("span");s.textContent=e.country,s.classList.add("truncate");const n=document.createElement("div");return n.appendChild(a),n.appendChild(s),n.classList.add("box"),n}(t)),o.appendChild(n),o.classList.add("d-flex","py-1","border-bottom"),e.appendChild(o)}}function a(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}class s{static async fetchData(e="tunisia"){try{let t=await fetch("https://corona.lmao.ninja/v2/countries/"+e),a=await t.json();if(a&&a.message)throw a.message;return a}catch(e){}}}let n=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);chrome=n?chrome:browser;let o=10,l=[],c={},d="tunisia";const r=document.getElementById("nav");let i=document.getElementById("tab-stats");const u=document.getElementById("list-countries"),h=document.getElementById("form-change-country"),m=document.getElementById("btn-load-more");function y({showHeader:e,showForm:a,showBtnMore:s,showStatsTabEl:n}){h.style.display=a,m.style.display=s,u.innerHTML="",t.hideHeader(e),i.style.display=n}function f(){let e=l.reduce((e,t)=>e+t.cases,0),t=l.reduce((e,t)=>e+t.deaths,0);i.innerHTML=`\n  <ul>\n  <li class="d-flex-col"><span class="txt-bleu mb-5">total cases</span> ${e}</li>\n  <li class="d-flex-col"><span class="txt-bleu mb-5">total deaths</span> ${t}</li>\n  </ul>\n  <ul>\n  <li class="d-flex-col"><span class="txt-bleu mb-5">total today cases</span> ${l.reduce((e,t)=>e+t.todayCases,0)}</li>\n  <li class="d-flex-col"><span class="txt-bleu mb-5">total today cases</span> ${l.reduce((e,t)=>e+t.todayDeaths,0)}</li>\n  <li class="d-flex-col"><span class="txt-bleu mb-5">total deaths/total cases</span> ${parseInt(t/e*100,10)}%</li>\n  </ul>`}function b(){l.sort((e,t)=>+t.cases-+e.cases).slice(0,o).forEach(e=>{t.createListCountries(u,e)}),m.addEventListener("click",()=>{o+=10,m.style.display="block",u.innerHTML="",l.sort((e,t)=>+t.cases-+e.cases).slice(0,o).forEach(e=>{t.createListCountries(u,e)})},!1)}chrome.storage.local.get(["defaultCountryName"],(function(e){y({showForm:"none",showBtnMore:"none"}),e&&e.defaultCountryName?s.fetchData(e.defaultCountryName).then(a=>{d=e.defaultCountryName,c=a,t.setHeader(d),t.createListCountries(u,a)}).catch(e=>{chrome.storage.local.set({defaultCountryName:"tunisia"}),window.location.reload()}):s.fetchData().then(e=>{c=e,t.setHeader(d),t.createListCountries(u,e)}).catch(e=>{})})),r.addEventListener("click",(function(e){switch(e.target.id||e.target.parentNode.id){case"all":y({showHeader:!1,showForm:"none",showBtnMore:"block",showStatsTabEl:"none"}),l.length>0&&b(),s.fetchData("").then(e=>{l=e.slice(0),b()});break;case"settings":y({showHeader:!1,showForm:"block",showBtnMore:"none",showStatsTabEl:"none"});let e=document.getElementById("alert");h.addEventListener("submit",t=>{t.preventDefault();let a=t.target.elements[0].value;/^[a-zA-Z]+$/.test(a)?(t.target.elements[0].disabled=!0,t.target.elements[1].disabled=!0,t.target.elements[1].textContent="Changed",t.target.elements[1].classList.add("bg-bleu"),e.style.display="none",chrome.storage.local.set({defaultCountryName:a}),window.location.reload()):(e.style.display="block",e.textContent="Invalid country name")},!1);break;case"stats":y({showHeader:!1,showForm:"none",showBtnMore:"none",showStatsTabEl:"flex"}),l.length>0?f():s.fetchData("").then(e=>{l=e.slice(0),f()});break;default:y({showHeader:!0,showForm:"none",showBtnMore:"none",showStatsTabEl:"none"}),c&&t.createListCountries(u,c)}Array.from(r.children).forEach(e=>{e.classList.remove("active-tab")}),e.target.id?e.target.classList.add("active-tab"):e.target.parentNode.classList.add("active-tab")}),!1)}));
